Warning: there are non-text parts in the response: ['executable_code', 'code_execution_result'], returning concatenated text result from text parts. Check the full candidates.content.parts accessor to get the full model response.
Starting 100-generation training...
============================================================
V3 CSE TRAINING - VERSION 3 (GROUND TRUTH FIXES)
============================================================
Agents: 8, Generations: 100, Seed: 42
Fitness: strong, Memory: True
HuggingFace datasets: False
Started: 2026-01-15T21:06:33.291726

==================================================
LOADING GROUND TRUTH TASK BANK
==================================================

Task bank summary:
  vision: 15 tasks ✅
  code_math: 15 tasks ✅
  web: 15 tasks ✅
  rag: 15 tasks ✅
  pure_qa: 12 tasks ✅

Ground truth coverage: 72/72 (100%)
==================================================
Initializing RIGOROUS RAG system...
  - ChromaDB vector store
  - BGE embeddings (BAAI/bge-small-en-v1.5)
  - NO TF-IDF fallback
Initializing Rigorous RAG System...
  Embedding model: BAAI/bge-small-en-v1.5
  Vector store: ChromaDB at /Users/yuhaoli/code/MAS_For_Finance/emergent_prompt_evolution/v3/data/chromadb_rigorous/natural_questions_rigorous
  ✓ BGE embeddings loaded
  ✓ ChromaDB collection: natural_questions_rigorous
  ✓ Vector index created (top_k=5)
  ✓ Gemini LLM initialized (google.genai 1.56+)
✓ Rigorous RAG System ready
  Indexed 10 documents into vector store
✓ Rigorous RAG system initialized

✅ Ground truth coverage: 100% (72/72 tasks)

Creating 8 agents (memory=True)...

Starting training with strong fitness penalty...
------------------------------------------------------------
Gen  10: SCI=0.000, Coverage=0%, Specialists=0, Calls=27
Gen  20: SCI=0.000, Coverage=0%, Specialists=0, Calls=55
Gen  30: SCI=0.000, Coverage=0%, Specialists=0, Calls=85
Gen  40: SCI=0.000, Coverage=0%, Specialists=0, Calls=115
Gen  50: SCI=0.000, Coverage=0%, Specialists=0, Calls=145
Gen  60: SCI=1.000, Coverage=20%, Specialists=1, Calls=174
Gen  70: SCI=0.500, Coverage=40%, Specialists=2, Calls=203
Gen  80: SCI=0.500, Coverage=40%, Specialists=2, Calls=233
Gen  90: SCI=0.500, Coverage=40%, Specialists=2, Calls=260
Gen 100: SCI=0.500, Coverage=40%, Specialists=2, Calls=290
------------------------------------------------------------
Training complete! API calls: 290

--- ROUTER TRAINING (Embedding-based) ---
Router trained: 5 mappings, 32 task patterns
Exact match accuracy: 14.3%
Regime prediction accuracy: 64.3%
Regime → Specialist: {'vision': 1, 'code_math': 7, 'web': 0, 'rag': 1, 'pure_qa': 0}

--- FINAL RESULTS ---
Specialists: 2/8
Coverage: 40%
Distribution: {'pure_qa': 1, 'code_math': 1}
Collision rate: 0%

--- MEMORY STATS ---
Total episodes: 70

--- RIGOROUS RAG METRICS ---
Embedding Model: BAAI/bge-small-en-v1.5
Vector Store: ChromaDB
Total RAG queries: 50
Retrieval hits: 12
Recall@5: 24.0%
Avg Latency: 1775ms

Results saved to: /Users/yuhaoli/code/MAS_For_Finance/emergent_prompt_evolution/v3/results/training_v2/seed_42

=== COMPLETE ===
Specialists: 2/8
Coverage: 40%
Distribution: {'pure_qa': 1, 'code_math': 1}
